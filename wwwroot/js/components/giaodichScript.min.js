var config={pageSize:10,pageIndex:1},giaodichScript={Init:function(){giaodichScript.loadData();giaodichScript.loadlichsu();giaodichScript.registerEvent()},registerEvent:function(){$(".btn-search").off("click").on("click",function(){giaodichScript.loadData(!0)});$("#txtSearch").keypress(function(n){n.keyCode===13&&giaodichScript.loadData(!0)});$(".btn-cancel").off("click").on("click",function(n){n.preventDefault();var t=$(this).data("id");giaodichScript.deleteRequest(t)})},deleteRequest:function(n){$.ajax({url:"/useraccount/delete",data:{id:n},type:"post",dataType:"json",success:function(n){n.status?(M.toast({html:"Xóa thành công",classes:"rounded  green lighten-1"}),giaodichScript.loadlichsu(),$("ul.nav.nav-tabs a:eq(1)").tab("show")):M.toast({html:"Xóa không thành công",classes:"rounded  oranger lighten-1"})}})},loadData:function(n){var t=$("#txtId").val();$.ajax({url:"/useraccount/lichsugiaodich",type:"POST",data:{userId:t,page:config.pageIndex,pageSize:config.pageSize},dataType:"json",success:function(t){if(t.status){var r=t.data,i="",u=$("#data-template").html();$.each(r,function(n,t){i+=Mustache.render(u,{Time:t.createdDate,SoTien:t.soTien.toLocaleString("it-IT",{style:"currency",currency:"VND"}),Content:t.content?"Nạp tiền vào tài khoản":"Trừ tiền tài khoản",Notes:t.notes})});$("#dataRender").html(i);t.total>config.pageSize?giaodichScript.paging(t.total,t.page,function(){giaodichScript.loadData()},n):$("#pagination").hide()}}})},loadlichsu:function(n){var t=$("#txtId").val();$.ajax({url:"/useraccount/lichsunapthe",type:"POST",data:{userId:t,page:config.pageIndex,pageSize:config.pageSize},dataType:"json",success:function(t){if(t.status){var r=t.data,i="",u=$("#history-template").html();$.each(r,function(n,t){i+=Mustache.render(u,{Id:t.id,Time:t.ngayNopThe,CardName:t.loaiThe,Price:t.menhGia.toLocaleString("it-IT",{style:"currency",currency:"VND"}),UnitPrice:t.giaChietKhau.toLocaleString("it-IT",{style:"currency",currency:"VND"}),Wanranty:t.soLuong,Required:t.requiredLabel,TrangThai:t.trangThai===!0?"Đã nạp":"Đang chờ",Notes:t.notes})});$("#lichsuRender").html(i);giaodichScript.registerEvent();t.total>config.pageSize?giaodichScript.paginghistory(t.total,t.page,function(){giaodichScript.loadlichsu()},n):$("#hispagination").hide()}}})},paging:function(n,t,i){$("#pagination").pagination({items:n,itemsOnPage:config.pageSize,currentPage:t,hrefTextPrefix:"#trang-",prevText:"&lt",nextText:"&gt;",cssStyle:"light-theme",onPageClick:function(n){config.pageIndex=n;currentPage=n;setTimeout(i,0)}})},paginghistory:function(n,t,i){$("#hispagination").pagination({items:n,itemsOnPage:config.pageSize,currentPage:t,hrefTextPrefix:"#trang-",prevText:"&lt",nextText:"&gt;",cssStyle:"light-theme",onPageClick:function(n){config.pageIndex=n;currentPage=n;setTimeout(i,0)}})}};giaodichScript.Init();