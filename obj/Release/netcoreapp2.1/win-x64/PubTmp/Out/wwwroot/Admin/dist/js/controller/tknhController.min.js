var config={pageSize:12,pageIndex:1,viewport:{width:189,height:245}},tknhController={init:function(){tknhController.registerEvent()},registerEvent:function(){jQuery.validator.setDefaults({debug:!0,success:"valid"});$("#frmAddNew").validate({rules:{Name:{required:!0},SoTK:{required:!0,number:!0},NguoiThuHuong:{required:!0},TenChiNhanh:{required:!0}},messages:{Name:{required:"Tên là bắt buộc"},SoTK:{required:"Yêu cầu nhập số tài khoản",number:"Số tài khoản không đúng định dạng"},NguoiThuHuong:{required:"Yêu cầu nhập người thụ hưởng"},TenChiNhanh:{required:"Yêu cầu nhập tên chi nhánh"}}});$("#frmUpdate").validate({rules:{EditName:{required:!0},EditSoTK:{required:!0,number:!0},EditNguoiThuHuong:{required:!0},EditTenChiNhanh:{required:!0}},messages:{EditName:{required:"Yêu cầu nhập tên ngân hàng"},EditSoTK:{required:"Yêu cầu số tài khoản",number:"Số tài khoản không đúng định dạng"},EditNguoiThuHuong:{required:"Yêu cầu tên người thụ hưởng"},EditTenChiNhanh:{required:"Yêu cầu tên chi nhánh"}}});$("#btnAdd").off("click").on("click",function(){$("#frmAddNew").valid()&&tknhController.Post()});$("#SaveEdit").off("click").on("click",function(){$("#frmUpdate").valid()&&tknhController.Put()});$(".btn-active").off("click").on("click",function(n){n.preventDefault();var i=$(this).data("id"),t=$(this);$.ajax({url:"/admin/taikhoanthe/ChangeStatus",data:{id:i},type:"post",dataType:"json",success:function(n){n.message===null?toastr.error(n.message):n.status?(t.removeClass("bg-red"),t.addClass("bg-green"),toastr.remove(),toastr.info("Đã kích hoạt"),t.html("<i class='fa fa-check'>Active<\/i>")):(t.removeClass("bg-green"),t.addClass("bg-red"),toastr.remove(),toastr.info("Đã hủy kích hoạt"),t.html("<i class='fa fa-ban'>NotActive<\/i>"))}})});$(".btnDelete").off("click").on("click",function(){var n=$(this).data("id");bootbox.confirm("Bạn có chắc chắn muốn xóa loại thẻ này không? ",function(t){t&&tknhController.delete(n)})});$(".format_number").autoNumeric("init");$(".btnEdit").off("click").on("click",function(n){n.preventDefault();var t=$(this).data("id");$("ul.nav.nav-tabs a:eq(2)").tab("show");tknhController.loadDetail(t)})},"delete":function(n){$.ajax({url:"/admin/taikhoanthe/Delete",data:{id:n},type:"post",dataType:"json",success:function(){toastr.success("Xóa thành công");tknhController.loadData(!0)}})},loadDetail:function(n){$.ajax({url:"/admin/taikhoanthe/GetDetail",data:{id:n},type:"POST",dataType:"json",success:function(n){if(n.status===!0){var t=n.data;$("#EditId").val(t.id);$("#EditName").val(t.tenNH);$("#EditSoTK").val(t.soTK);$("#EditNguoiThuHuong").val(t.nguoiThuHuong);$("#EditTenChiNhanh").val(t.tenChiNhanh);$("#EditStatus").prop("checked",t.status)}else toastr.error(n.message)}})},Post:function(){var n=$("#txtName").val(),t=$("#txtSoTK").val(),i=$("#txtNguoiThuHuong").val(),r=$("#txtTenChiNhanh").val(),u=$("#txtStatus").prop("checked"),f={TenNH:n,SoTK:t,NguoiThuHuong:i,TenChiNhanh:r,Status:u};$.ajax({url:"/admin/taikhoanthe/post",data:{tknh:JSON.stringify(f)},type:"post",dataType:"json",success:function(n){n.status?(location.reload(),toastr.success(n.message)):toastr.error(n.message)}})},Put:function(){var n=$("#EditId").val(),t=$("#EditName").val(),i=$("#EditSoTK").val(),r=$("#EditNguoiThuHuong").val(),u=$("#EditTenChiNhanh").val(),f=$("#EditStatus").prop("checked"),e={Id:n,TenNH:t,SoTk:i,NguoiThuHuong:r,TenChiNhanh:u,Status:f};$.ajax({url:"/admin/taikhoanthe/put",data:{tknh:JSON.stringify(e)},type:"post",dataType:"json",success:function(n){n.status?(location.reload(),toastr.success(n.message)):toastr.error(n.message)}})}};tknhController.init();