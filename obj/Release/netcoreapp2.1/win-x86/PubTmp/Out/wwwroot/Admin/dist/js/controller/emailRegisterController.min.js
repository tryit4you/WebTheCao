var config={pageSize:20,pageIndex:1},emailRegisterController={init:function(){emailRegisterController.loadData();emailRegisterController.registerEvent()},registerEvent:function(){$("#btn-Deletemulti").off("click").on("click",function(){bootbox.confirm("Bạn có chắc muốn xóa các bản ghi được chọn không?",function(n){n&&emailRegisterController.deleteMul()})});$("#btn-SendMail").off("click").on("click",function(){var n=[];$("td input:checked").each(function(){n.push($(this).data("id"))});n.length===0?toastr.error("bạn vui lòng chọn ít nhất một email!"):$.ajax({url:"/admin/Feedback/sendemails",data:{ids:n},type:"get",dataType:"json",success:function(n){console.log(n.message)}})});$("#selectAll").change(function(){$(".selectedItem").prop("checked",$(this).prop("checked"))})},deleteMul:function(){var n=[];$("td input:checked").each(function(){n.push($(this).data("id"))});n.length===0?toastr.error("Không có phần tử nào được chọn!"):$.ajax({url:"/admin/Feedback/DeleteEmail",data:{ids:n},type:"post",dataType:"json",success:function(n){toastr.success(n.message);emailRegisterController.loadData(!0)}})},loadData:function(n){$.ajax({url:"/admin/Feedback/GetEmailRegister",type:"post",data:{page:config.pageIndex,pageSize:config.pageSize},dataType:"json",success:function(t){var r;if(t.status){var u=t.data,i="",f=$("#data-template").html();$.each(u,function(n,t){i+=Mustache.render(f,{ID:t.id,Email:t.email})});$("#tbData").html(i);r=Math.ceil(t.total/config.pageSize);emailRegisterController.paging(t.total,function(){emailRegisterController.loadData();$("#currentpage").html(config.pageIndex);$("#totalpage").html(r)},n);emailRegisterController.registerEvent()}}})},paging:function(n,t,i){var r=Math.ceil(n/config.pageSize);($("#pagination a").length===0||i===!0)&&($("#pagination").empty(),$("#pagination").removeData("twbs-pagination"),$("#pagination").unbind("page"));$("#pagination").twbsPagination({totalPages:r,first:"Đầu",prev:"Trước",next:"Tiếp ",last:"Cuối",visiblePages:10,onPageClick:function(n,i){config.pageIndex=i;setTimeout(t,200)}})}};emailRegisterController.init();